https://www.sqlshack.com/use-window-functions-sql-server/